graph TB
    subgraph "User Interface Layer"
        WEB[React Web App<br/>- Desktop Experience<br/>- Advanced Analytics<br/>- Deep Research Tools]
        MOBILE[React Native/PWA<br/>- Mobile-First UI<br/>- Quick Decisions<br/>- Push Notifications<br/>- Swipe Gestures]
        API_MOBILE[Mobile API Gateway<br/>- Optimized Responses<br/>- Reduced Payloads<br/>- Offline Caching]
    end
    
    subgraph "API Gateway Layer"
        API[FastAPI Backend<br/>- Request Routing<br/>- Authentication<br/>- Rate Limiting<br/>- Input Validation]
        AUTH[User Authentication<br/>- JWT Tokens<br/>- Subscription Management<br/>- Preference Storage]
    end
    
    subgraph "Enhanced Agent Orchestration Layer"
        ORCH[LangChain Orchestrator<br/>- Agent Coordination<br/>- Workflow Management<br/>- Response Synthesis<br/>- Mobile Optimization]
        
        CA[Context Analyzer Agent<br/>- Query Understanding<br/>- Intent Classification<br/>- Route Planning<br/>- User Context Injection]
        
        SE[Stats Engine Agent<br/>- Data Analysis<br/>- Player Comparisons<br/>- Metric Calculations<br/>- Fantasy Point Projections]
        
        DI[Data Ingestion Agent<br/>- API Calls<br/>- Data Fetching<br/>- Cache Management<br/>- Real-time Updates]
        
        NG[Narrative Generator<br/>- Response Crafting<br/>- Explanation Generation<br/>- Output Formatting<br/>- Mobile-Friendly Summaries]
        
        FC[Fact Checker Agent<br/>- Data Validation<br/>- Source Verification<br/>- Confidence Scoring]
        
        %% NEW: Enhanced Agents
        CI[Community Intelligence Agent<br/>- Social Media Analysis<br/>- Expert Consensus<br/>- Sentiment Scoring<br/>- Trending Detection]
        
        MA[Matchup Analysis Agent<br/>- Opponent Research<br/>- Defensive Breakdowns<br/>- Historical Performance<br/>- Advantage Identification]
        
        PA[Personalization Agent<br/>- User Preference Learning<br/>- Decision History Analysis<br/>- Risk Tolerance Modeling<br/>- Custom Recommendations]
        
        NOTIF[Notification Agent<br/>- Breaking News Alerts<br/>- Injury Updates<br/>- Lineup Suggestions<br/>- Mobile Push Messages]
    end
    
    subgraph "Enhanced Data Storage Layer"
        MILVUS[(Milvus Vector DB<br/>- Player Profiles<br/>- Game Summaries<br/>- News Content<br/>- Community Sentiment<br/>- Semantic Search)]
        
        NEO4J[(Neo4j Graph DB<br/>- Player Relationships<br/>- Team Connections<br/>- Career Paths<br/>- Matchup History<br/>- User Preferences)]
        
        REDIS[(Redis Cache<br/>- API Responses<br/>- Query Results<br/>- Session Data<br/>- Real-time Stats<br/>- Mobile Payloads)]
        
        POSTGRES[(PostgreSQL<br/>- User Accounts<br/>- Decision History<br/>- Subscription Data<br/>- Analytics Tracking)]
    end
    
    subgraph "External Data Sources"
        NBA_API[NBA Stats API<br/>- Player Statistics<br/>- Game Data<br/>- Team Information]
        
        ESPN_API[ESPN API<br/>- News Articles<br/>- Injury Reports<br/>- Schedule Data]
        
        BBR[Basketball Reference<br/>- Historical Data<br/>- Advanced Metrics<br/>- Career Statistics]
        
        %% NEW: Community Data Sources
        REDDIT_API[Reddit API<br/>- r/fantasybball<br/>- Community Discussions<br/>- Player Sentiment]
        
        TWITTER_API[Twitter API<br/>- Expert Opinions<br/>- Breaking News<br/>- Trending Topics]
        
        EXPERT_APIs[Expert Consensus APIs<br/>- FantasyPros<br/>- Ownership Data<br/>- Start/Sit Advice]
    end
    
    subgraph "Real-time Processing Layer"
        STREAM[Real-time Stream Processor<br/>- Live Game Updates<br/>- Injury Alerts<br/>- News Processing<br/>- Mobile Notifications]
        
        SCHEDULER[Task Scheduler<br/>- Daily Data Updates<br/>- Community Sentiment Analysis<br/>- User Preference Learning]
    end
    
    subgraph "Monitoring & Observability"
        LANGSMITH[LangSmith<br/>- Agent Tracing<br/>- Performance Metrics<br/>- Query Analysis<br/>- Mobile Performance]
        
        LOGS[Application Logging<br/>- Error Tracking<br/>- Usage Analytics<br/>- System Health<br/>- Mobile Metrics]
        
        ANALYTICS[User Analytics<br/>- Decision Accuracy<br/>- Feature Usage<br/>- Mobile Behavior<br/>- Personalization Success]
    end
    
    %% User Flow - Enhanced for Mobile
    WEB --> API
    MOBILE --> API_MOBILE
    API_MOBILE --> API
    API --> AUTH
    AUTH --> ORCH
    
    %% Agent Orchestration - Enhanced
    ORCH --> CA
    ORCH --> SE
    ORCH --> DI
    ORCH --> NG
    ORCH --> FC
    ORCH --> CI
    ORCH --> MA
    ORCH --> PA
    ORCH --> NOTIF
    
    %% Data Access Patterns - Enhanced
    CA --> MILVUS
    CA --> NEO4J
    CA --> POSTGRES
    SE --> MILVUS
    SE --> REDIS
    DI --> NBA_API
    DI --> ESPN_API
    DI --> BBR
    DI --> REDIS
    NG --> MILVUS
    FC --> NEO4J
    
    %% NEW: Community Intelligence Data Flow
    CI --> REDDIT_API
    CI --> TWITTER_API
    CI --> EXPERT_APIs
    CI --> MILVUS
    CI --> REDIS
    
    %% NEW: Matchup Analysis Data Flow
    MA --> NBA_API
    MA --> NEO4J
    MA --> MILVUS
    
    %% NEW: Personalization Data Flow
    PA --> POSTGRES
    PA --> NEO4J
    PA --> REDIS
    
    %% NEW: Real-time Processing
    STREAM --> REDIS
    STREAM --> NOTIF
    SCHEDULER --> CI
    SCHEDULER --> PA
    
    %% Monitoring Connections - Enhanced
    ORCH --> LANGSMITH
    API --> LOGS
    PA --> ANALYTICS
    MOBILE --> ANALYTICS
    
    %% Styling
    classDef userLayer fill:#e1f5fe
    classDef apiLayer fill:#f3e5f5
    classDef agentLayer fill:#e8f5e8
    classDef dataLayer fill:#fff3e0
    classDef externalLayer fill:#ffebee
    classDef monitorLayer fill:#f1f8e9
    classDef realtimeLayer fill:#fce4ec
    
    class WEB,MOBILE,API_MOBILE userLayer
    class API,AUTH apiLayer
    class ORCH,CA,SE,DI,NG,FC,CI,MA,PA,NOTIF agentLayer
    class MILVUS,NEO4J,REDIS,POSTGRES dataLayer
    class NBA_API,ESPN_API,BBR,REDDIT_API,TWITTER_API,EXPERT_APIs externalLayer
    class LANGSMITH,LOGS,ANALYTICS monitorLayer
    class STREAM,SCHEDULER realtimeLayer