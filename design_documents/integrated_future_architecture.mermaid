graph TB
    subgraph "Enhanced Data Sources & Streaming"
        SOURCES[External APIs<br/>NBA, ESPN, News]
        COMMUNITY_APIS[Community APIs<br/>Reddit, Twitter<br/>Expert Consensus<br/>Social Media]
        KAFKA[Apache Kafka<br/>- Real-time Events<br/>- Game Updates<br/>- Breaking News<br/>- Community Sentiment<br/>- User Interactions]
        BATCH[Batch Sources<br/>- Historical Data<br/>- Season Archives<br/>- Media Content<br/>- User Analytics]
        USER_STREAM[User Event Stream<br/>- Query Patterns<br/>- Decision Tracking<br/>- Mobile Interactions<br/>- Personalization Events]
    end
    
    subgraph "Enhanced Orchestration & Scheduling"
        AIRFLOW[Apache Airflow<br/>- ETL Orchestration<br/>- Data Pipeline Management<br/>- Dependency Resolution<br/>- Error Handling<br/>- Community Data Sync<br/>- User Model Updates]
    end
    
    subgraph "Enhanced Data Engineering Pipeline"
        subgraph "Bronze Layer - Raw Data"
            LAKE[Data Lake S3/GCS<br/>- Raw JSON Files<br/>- Unprocessed Media<br/>- Event Streams<br/>- Archive Storage<br/>- Community Data<br/>- User Interaction Logs]
        end
        
        subgraph "Silver Layer (Processed)"
            DBT[dbt Transformations<br/>- Data Cleaning & Validation<br/>- Business Logic<br/>- Quality Tests<br/>- Documentation<br/>- Sentiment Processing<br/>- User Behavior Modeling]
            
            DWH[Data Warehouse<br/>Snowflake/BigQuery<br/>- Structured Tables<br/>- Normalized Schema<br/>- Historical Tracking<br/>- User Profiles<br/>- Community Metrics]
        end
        
        subgraph "Gold Layer - Analytics Ready"
            ANALYTICS[Analytics Tables<br/>- Pre-computed Metrics<br/>- Aggregated Stats<br/>- Trend Analysis<br/>- Performance KPIs<br/>- Community Insights<br/>- User Segmentation]
            
            FEATURES[Feature Store<br/>- ML Ready Features<br/>- Real-time Serving<br/>- Feature Lineage<br/>- Version Control<br/>- Personalization Features<br/>- Sentiment Features]
            
            USER_FEATURES[User Feature Store<br/>- Decision Accuracy<br/>- Preference Vectors<br/>- Risk Profiles<br/>- Engagement Patterns<br/>- Mobile Behavior]
        end
    end
    
    subgraph "Enhanced AI/ML Platform"
        subgraph "Machine Learning"
            MODELS[ML Models<br/>- Player Performance Prediction<br/>- Game Outcome Models<br/>- Similarity Algorithms<br/>- Injury Risk Assessment<br/>- Sentiment Prediction<br/>- User Preference Models]
            
            TRAINING[Model Training<br/>- Automated Pipelines<br/>- Hyperparameter Tuning<br/>- Model Validation<br/>- A/B Testing<br/>- Personalization Models<br/>- Community Models]
            
            PERSONALIZATION_ML[Personalization ML<br/>- User Clustering<br/>- Recommendation Systems<br/>- Risk Tolerance Models<br/>- Decision Pattern Analysis<br/>- Mobile Behavior Prediction]
        end
        
        subgraph "Enhanced SportsBrain Agents"
            PREDICTOR[Prediction Agent<br/>- Game Forecasting<br/>- Player Performance<br/>- Trade Impact Analysis<br/>- Community Sentiment Trends]
            
            COMMUNITY_AGENT[Community Intelligence Agent<br/>- Sentiment Analysis<br/>- Expert Consensus<br/>- Social Proof Generation<br/>- Trend Detection]
            
            PERSONALIZATION_AGENT[Personalization Agent<br/>- User Preference Learning<br/>- Decision History Analysis<br/>- Risk-Adjusted Recommendations<br/>- Mobile Optimization]
            
            MATCHUP_AGENT[Matchup Intelligence Agent<br/>- Opponent Analysis<br/>- Defensive Breakdowns<br/>- Historical Performance<br/>- Advantage Identification]
            
            ENHANCED_AGENTS[Core Agents Enhanced<br/>- Richer Context<br/>- Predictive Insights<br/>- Real-time Updates<br/>- Community Integration<br/>- Personalization Layer]
            
            VECTOR_ENH[(Enhanced Vector Store<br/>- Multimodal Embeddings<br/>- Video Content<br/>- Rich Metadata<br/>- Community Sentiment Vectors<br/>- User Preference Embeddings)]
            
            GRAPH_ENH[(Enhanced Graph DB<br/>- Complex Relationships<br/>- Temporal Connections<br/>- Multi-dimensional Analysis<br/>- User Behavior Networks<br/>- Community Interaction Graphs)]
            
            USER_GRAPH[(User Knowledge Graph<br/>- Decision Patterns<br/>- Preference Networks<br/>- Success Correlations<br/>- Risk Profiles)]
        end
    end
    
    subgraph "Enhanced Analytics & Business Intelligence"
        DASHBOARDS[BI Dashboards<br/>- User Analytics<br/>- System Performance<br/>- Business Metrics<br/>- Revenue Tracking<br/>- Community Engagement<br/>- Personalization Success]
        
        REPORTS[Automated Reports<br/>- Daily Insights<br/>- Model Performance<br/>- Data Quality Metrics<br/>- User Engagement<br/>- Community Health<br/>- Personalization ROI]
        
        USER_ANALYTICS[User Analytics Platform<br/>- Decision Accuracy Tracking<br/>- Engagement Scoring<br/>- Churn Prediction<br/>- Feature Usage Analysis<br/>- Mobile vs Desktop Behavior]
    end
    
    subgraph "Enhanced Application Layer"
        API_ENH[Enhanced API<br/>- Real-time Predictions<br/>- Personalized Responses<br/>- Multi-modal Output<br/>- Advanced Analytics<br/>- Community Intelligence<br/>- Mobile-Optimized Endpoints]
        
        WEBAPP_ENH[Advanced Web App<br/>- Personalization Engine<br/>- Real-time Updates<br/>- Rich Visualizations<br/>- Mobile Responsive<br/>- Community Features<br/>- User Dashboards]
        
        MOBILE[Mobile App<br/>- Push Notifications<br/>- Offline Capabilities<br/>- Location-based Features<br/>- Quick Decision Tools<br/>- Swipe Interfaces<br/>- Community Integration]
        
        NOTIFICATION_ENGINE[Notification Engine<br/>- Smart Alerts<br/>- User Preference Filtering<br/>- Mobile Push Optimization<br/>- Breaking News Priority<br/>- Community Updates]
    end
    
    subgraph "Enhanced Monitoring & Observability"
        MONITORING[Enhanced Monitoring<br/>- Data Quality Metrics<br/>- Model Drift Detection<br/>- Pipeline Health<br/>- Cost Optimization<br/>- User Experience Tracking<br/>- Personalization Performance]
        
        ALERTING[Intelligent Alerting<br/>- Anomaly Detection<br/>- Performance Degradation<br/>- Data Freshness<br/>- User Experience Issues<br/>- Community Sentiment Alerts<br/>- Personalization Failures]
        
        USER_MONITORING[User Experience Monitoring<br/>- Response Time Tracking<br/>- Decision Accuracy Monitoring<br/>- Feature Adoption Analysis<br/>- Mobile Performance Metrics<br/>- Satisfaction Scoring]
    end
    
    subgraph "Security & Privacy Layer"
        PRIVACY[Privacy & Security<br/>- User Data Protection<br/>- GDPR Compliance<br/>- Data Anonymization<br/>- Secure User Profiles<br/>- Community Data Ethics]
    end
    
    %% Enhanced Data Flow Connections
    SOURCES --> KAFKA
    COMMUNITY_APIS --> KAFKA
    USER_STREAM --> KAFKA
    SOURCES --> AIRFLOW
    BATCH --> AIRFLOW
    
    KAFKA --> LAKE
    AIRFLOW --> LAKE
    
    LAKE --> DBT
    DBT --> DWH
    DWH --> ANALYTICS
    DWH --> FEATURES
    DWH --> USER_FEATURES
    
    FEATURES --> MODELS
    USER_FEATURES --> PERSONALIZATION_ML
    ANALYTICS --> TRAINING
    MODELS --> PREDICTOR
    
    FEATURES --> ENHANCED_AGENTS
    USER_FEATURES --> PERSONALIZATION_AGENT
    ANALYTICS --> ENHANCED_AGENTS
    PREDICTOR --> ENHANCED_AGENTS
    COMMUNITY_APIS --> COMMUNITY_AGENT
    PERSONALIZATION_ML --> PERSONALIZATION_AGENT
    
    ENHANCED_AGENTS --> VECTOR_ENH
    ENHANCED_AGENTS --> GRAPH_ENH
    PERSONALIZATION_AGENT --> USER_GRAPH
    COMMUNITY_AGENT --> VECTOR_ENH
    MATCHUP_AGENT --> GRAPH_ENH
    
    ANALYTICS --> DASHBOARDS
    USER_FEATURES --> USER_ANALYTICS
    MODELS --> REPORTS
    
    ENHANCED_AGENTS --> API_ENH
    COMMUNITY_AGENT --> API_ENH
    PERSONALIZATION_AGENT --> API_ENH
    API_ENH --> WEBAPP_ENH
    API_ENH --> MOBILE
    API_ENH --> NOTIFICATION_ENGINE
    
    %% Enhanced Monitoring Connections
    DWH --> MONITORING
    MODELS --> MONITORING
    API_ENH --> MONITORING
    USER_ANALYTICS --> USER_MONITORING
    MONITORING --> ALERTING
    PERSONALIZATION_AGENT --> USER_MONITORING
    
    %% Enhanced Feedback Loops
    WEBAPP_ENH -.-> USER_STREAM
    MOBILE -.-> USER_STREAM
    USER_ANALYTICS -.-> PERSONALIZATION_ML
    REPORTS -.-> FEATURES
    ALERTING -.-> AIRFLOW
    USER_MONITORING -.-> PERSONALIZATION_AGENT
    NOTIFICATION_ENGINE -.-> USER_STREAM
    
    %% Privacy & Security
    USER_GRAPH --> PRIVACY
    USER_FEATURES --> PRIVACY
    PERSONALIZATION_AGENT --> PRIVACY
    
    %% Styling
    classDef sourceLayer fill:#ffebee
    classDef orchestrationLayer fill:#e3f2fd
    classDef bronzeLayer fill:#fff3e0
    classDef silverLayer fill:#e8f5e8
    classDef goldLayer fill:#f3e5f5
    classDef mlLayer fill:#fce4ec
    classDef appLayer fill:#e1f5fe
    classDef monitorLayer fill:#f1f8e9
    classDef enhancedLayer fill:#e8eaf6
    classDef securityLayer fill:#f3e5f5
    
    class SOURCES,KAFKA,BATCH sourceLayer
    class COMMUNITY_APIS,USER_STREAM enhancedLayer
    class AIRFLOW orchestrationLayer
    class LAKE bronzeLayer
    class DBT,DWH silverLayer
    class ANALYTICS,FEATURES goldLayer
    class USER_FEATURES enhancedLayer
    class MODELS,TRAINING,PREDICTOR,ENHANCED_AGENTS,VECTOR_ENH,GRAPH_ENH mlLayer
    class PERSONALIZATION_ML,COMMUNITY_AGENT,PERSONALIZATION_AGENT,MATCHUP_AGENT,USER_GRAPH enhancedLayer
    class API_ENH,WEBAPP_ENH,MOBILE,DASHBOARDS,REPORTS,NOTIFICATION_ENGINE appLayer
    class USER_ANALYTICS enhancedLayer
    class MONITORING,ALERTING,USER_MONITORING monitorLayer
    class PRIVACY securityLayer