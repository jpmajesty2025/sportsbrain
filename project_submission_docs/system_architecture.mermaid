graph TB
    %% System Architecture - Actually Implemented
    %% SportsBrain Fantasy Basketball Platform
    
    subgraph "Railway Platform Deployment"
        subgraph "Frontend (Railway)"
            UI["React Frontend<br/>TypeScript + Material-UI"]
            UI_COMP["Components:<br/>Dashboard<br/>Agent Cards<br/>Chat Interface<br/>Login/Register"]
        end
        
        subgraph "Backend API (Railway)"
            API["FastAPI Backend<br/>Python 3.11"]
            
            AUTH["Auth Endpoints<br/>JWT + bcrypt"]
            AGENT_EP["Agent Endpoints<br/>/api/v1/agents/"]
            SECURE_EP["Secure Endpoints<br/>/api/v1/secure/"]
        end
    end
    
    subgraph "Agent Layer - LangChain"
        INT_AGENT["Intelligence Agent<br/>6 Tools + Reranking"]
        DRAFT_AGENT["DraftPrep Agent<br/>6 Tools + Reranking"]
        TRADE_AGENT["TradeImpact Agent<br/>5 Tools + Reranking"]
        
        TOOLS["Agent Tools:<br/>SQL Queries<br/>Vector Search<br/>Calculations<br/>Analysis"]
        
        RERANKER["ReRanker Service<br/>BGE Cross-Encoder<br/>BAAI/bge-reranker-large<br/>Two-stage retrieval"]
    end
    
    subgraph "Security Layer - 5 Layers"
        INPUT_VAL["Input Validator<br/>35+ attack patterns"]
        PROMPT_GUARD["Prompt Guards<br/>Topic restriction"]
        OUTPUT_FILTER["Output Filter<br/>Data redaction"]
        RATE_LIMIT["Rate Limiter<br/>20/min, 200/hr"]
        SECURE_WRAPPER["Secure Agent Wrapper<br/>Orchestrates all layers"]
    end
    
    subgraph "Data Layer"
        subgraph "Primary Storage (Railway)"
            PG[("PostgreSQL<br/>151 players<br/>100 games<br/>Fantasy data")]
            REDIS[("Redis<br/>Configured<br/>Not in use")]
        end
        
        subgraph "Vector Storage (Zilliz Cloud)"
            MILVUS[("Milvus<br/>1,007 embeddings<br/>3 collections")]
        end
        
        subgraph "Graph Storage (Neo4j Aura)"
            NEO4J[("Neo4j<br/>804 nodes<br/>719 relationships")]
        end
    end
    
    subgraph "External Services"
        OPENAI["OpenAI API<br/>GPT-3.5-turbo<br/>Embeddings"]
    end
    
    subgraph "Planned External Services"
        NBA_API["NBA Stats API<br/>Future integration"]
    end
    
    subgraph "Infrastructure Providers"
        RAILWAY_INFRA["Railway.app<br/>Hosts: Frontend, Backend,<br/>PostgreSQL, Redis"]
        ZILLIZ_INFRA["Zilliz Cloud<br/>Hosts: Milvus"]
        NEO4J_INFRA["Neo4j Aura<br/>Hosts: Neo4j"]
        GITHUB["GitHub<br/>Source control<br/>CI/CD Actions"]
    end
    
    %% Connections
    UI --> API
    API --> AUTH
    API --> AGENT_EP
    API --> SECURE_EP
    
    AGENT_EP --> INT_AGENT
    AGENT_EP --> DRAFT_AGENT
    AGENT_EP --> TRADE_AGENT
    
    SECURE_EP --> SECURE_WRAPPER
    SECURE_WRAPPER --> INPUT_VAL
    INPUT_VAL --> PROMPT_GUARD
    PROMPT_GUARD --> OUTPUT_FILTER
    OUTPUT_FILTER --> RATE_LIMIT
    RATE_LIMIT --> SECURE_WRAPPER
    SECURE_WRAPPER --> INT_AGENT
    
    INT_AGENT --> TOOLS
    DRAFT_AGENT --> TOOLS
    TRADE_AGENT --> TOOLS
    
    INT_AGENT --> RERANKER
    DRAFT_AGENT --> RERANKER
    TRADE_AGENT --> RERANKER
    
    TOOLS --> PG
    TOOLS --> MILVUS
    TOOLS --> NEO4J
    
    RERANKER --> MILVUS
    
    API --> REDIS
    
    INT_AGENT --> OPENAI
    DRAFT_AGENT --> OPENAI
    TRADE_AGENT --> OPENAI
    
    
    %% Infrastructure relationships shown via subgraph grouping
    
    style UI fill:#e3f2fd
    style API fill:#fff3e0
    style INT_AGENT fill:#e8f5e9
    style DRAFT_AGENT fill:#fce4ec
    style TRADE_AGENT fill:#f3e5f5
    style PG fill:#bbdefb
    style MILVUS fill:#c5cae9
    style NEO4J fill:#d7ccc8
    style REDIS fill:#ffccbc
    style INPUT_VAL fill:#ffebee
    style RERANKER fill:#fff176